<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Alejandra & Ever üíç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:"Georgia",serif;
  background:linear-gradient(#fff,#f9f6f7);
  color:#7b1e3a;
  text-align:center;
}
.container{max-width:680px;margin:auto;padding:40px 20px}
h1{font-size:38px}
.fecha{margin-bottom:30px;color:#a23b5c}
.card{
  background:white;
  padding:32px;
  border-radius:26px;
  box-shadow:0 14px 35px rgba(0,0,0,.08);
  margin-bottom:40px
}
input,textarea{
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:12px;
  border:1px solid #ddd;
  font-family:inherit;
}
textarea{resize:none;height:90px}
button{
  margin-top:18px;
  background:#7b1e3a;
  color:white;
  border:none;
  padding:15px 40px;
  border-radius:30px;
  font-size:17px;
  cursor:pointer
}
.sec-title{margin:60px 0 20px;font-size:26px}

/* ===== OVERLAY ===== */
.overlay{
  position:fixed;inset:0;
  background:rgba(255,255,255,.96);
  z-index:3000;
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column
}
.loader{display:flex;gap:10px}
.loader span{
  font-size:30px;
  color:#7b1e3a;
  animation:latir 1.4s infinite ease-in-out
}
.loader span:nth-child(2){animation-delay:.2s}
.loader span:nth-child(3){animation-delay:.4s}
@keyframes latir{
  0%{transform:scale(1);opacity:.4}
  20%{transform:scale(1.4);opacity:1}
  40%{transform:scale(1);opacity:.4}
}

/* ===== CARRUSEL ===== */
.carousel{position:relative;overflow:hidden}
.track{display:flex;gap:15px;transition:transform .6s ease}
.track img{
  width:180px;height:180px;
  object-fit:cover;
  border-radius:18px;
  box-shadow:0 8px 20px rgba(0,0,0,.15);
  cursor:pointer
}
.flecha{
  position:absolute;top:50%;
  transform:translateY(-50%);
  background:rgba(0,0,0,.55);
  color:white;border:none;
  font-size:26px;padding:10px 16px;
  border-radius:50%;cursor:pointer
}
.flecha.izq{left:10px}
.flecha.der{right:10px}

/* ===== MODAL RECUERDOS ===== */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.92);
  z-index:2000;
  align-items:center;
  justify-content:center
}
.visor{
  width:96%;max-width:1000px;height:80vh;
  background:rgba(0,0,0,.6);
  border-radius:24px;
  display:flex;align-items:center;justify-content:center;
  position:relative;overflow:hidden
}
.visor img,.visor iframe{
  width:100%;height:100%;object-fit:contain;border:none
}
.nav{
  position:absolute;top:50%;
  transform:translateY(-50%);
  background:rgba(0,0,0,.45);
  color:white;border:none;
  font-size:34px;padding:18px 20px;
  border-radius:50%;cursor:pointer
}
.nav.izq{left:20px}
.nav.der{right:20px}
.cerrar{
  position:absolute;top:18px;right:22px;
  font-size:38px;color:white;cursor:pointer
}
.contador{
  position:absolute;top:22px;right:70px;
  font-size:14px;color:white;opacity:.85
}
.descargar{
  position:absolute;bottom:28px;
  background:rgba(255,255,255,.18);
  color:white;border:1px solid rgba(255,255,255,.35);
  padding:8px 18px;border-radius:20px;font-size:14px
}

/* ===== MENSAJES ===== */
.mensajes-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:18px;
  margin-top:20px
}
.msg{
  background:white;
  padding:20px;
  border-radius:18px;
  box-shadow:0 8px 20px rgba(0,0,0,.1);
  animation:fade .5s ease
}
.msg strong{display:block;margin-bottom:6px}
@keyframes fade{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}
</style>
</head>

<body>

<div class="container">
  <h1>Alejandra & Ever</h1>
  <div class="fecha">üíç 5 ¬∑ septiembre ¬∑ 2026</div>

  <!-- SUBIR RECUERDOS -->
  <div class="card">
    <p>Ay√∫danos a guardar estos recuerdos para siempre üíï</p>
    <input type="file" id="file" multiple accept="image/*,video/*">
    <button id="btnSubir">Subir recuerdos üì∏üé•</button>
    <p id="estado"></p>
  </div>

  <!-- MENSAJE -->
  <div class="card">
    <p>üíå D√©janos un mensaje de amor</p>
    <input id="nombre" placeholder="Tu nombre">
    <textarea id="mensaje" placeholder="Escribe algo lindo‚Ä¶"></textarea>
    <button id="btnMensaje">Enviar mensaje üíï</button>
  </div>

  <h2 class="sec-title">Nuestros recuerdos üíï</h2>

  <div class="carousel">
    <button class="flecha izq" onclick="mover(-1)">‚óÄ</button>
    <div class="track" id="galeria"></div>
    <button class="flecha der" onclick="mover(1)">‚ñ∂</button>
  </div>

  <button onclick="abrirModal()">Ver todos los recuerdos üíñ</button>
  <button onclick="abrirMensajes()">Ver mensajes üíå</button>
</div>

<!-- OVERLAY -->
<div id="overlay" class="overlay">
  <div class="loader"><span>‚ù§</span><span>‚ù§</span><span>‚ù§</span></div>
  <p style="margin-top:18px">
    Guardando este momento con mucho amor üíï
  </p>
</div>

<!-- MODAL RECUERDOS -->
<div id="modal" class="modal">
  <span class="cerrar" onclick="modal.style.display='none'">√ó</span>
  <div class="visor">
    <button class="nav izq" onclick="anterior()">‚ùÆ</button>
    <button class="nav der" onclick="siguiente()">‚ùØ</button>
    <div id="modalContenido"></div>
    <div id="contador" class="contador"></div>
    <button id="btnDescargar" class="descargar">Guardar recuerdo ‚¨áÔ∏è</button>
  </div>
</div>

<!-- MODAL MENSAJES -->
<div id="modalMensajes" class="modal">
  <span class="cerrar" onclick="modalMensajes.style.display='none'">√ó</span>
  <div class="visor" style="background:white;color:#7b1e3a;overflow:auto">
    <div class="mensajes-grid" id="listaMensajes"></div>
  </div>
</div>

<script>
const URL_SCRIPT="https://script.google.com/macros/s/AKfycbwWBfvrIg-Kq4HkbRxnracrI0svNSTLNipOW_5zOcdU4P1eYvacq5eK7JOLe0frUPUq/exec";
let recuerdos=[],fotos=[],idx=0,ci=0,auto=null;

/* ===== CARGAR ===== */
async function cargar(){
  recuerdos=await fetch(URL_SCRIPT).then(r=>r.json());
  fotos=recuerdos.filter(r=>r.type==="image");
  renderCarrusel();
}
cargar();

/* ===== SUBIR ===== */
btnSubir.onclick=async()=>{
  if(!file.files.length){
    estado.innerText="Selecciona al menos un recuerdo üíï";return;
  }
  overlay.style.display="flex";
  for(const f of file.files){
    const r=new FileReader();
    await new Promise(res=>{
      r.onload=async()=>{
        await fetch(URL_SCRIPT,{
          method:"POST",
          body:JSON.stringify({
            name:f.name,type:f.type,
            base64:r.result.split(",")[1]
          })
        });res();
      };
      r.readAsDataURL(f);
    });
  }
  overlay.style.display="none";
  estado.innerText="¬°Gracias por compartir este recuerdo! üíñ";
  cargar();
};

/* ===== MENSAJE ===== */
btnMensaje.onclick=async()=>{
  if(!nombre.value || !mensaje.value)return;
  overlay.style.display="flex";
  await fetch(URL_SCRIPT,{
    method:"POST",
    body:JSON.stringify({
      nombre:nombre.value,
      mensaje:mensaje.value
    })
  });
  nombre.value="";mensaje.value="";
  overlay.style.display="none";
  alert("¬°Mensaje enviado con amor! üíï");
};

/* ===== MENSAJES ===== */
async function abrirMensajes(){
  const data=await fetch(URL_SCRIPT+"?mensajes=1").then(r=>r.json());
  listaMensajes.innerHTML="";
  data.reverse().forEach(m=>{
    const d=document.createElement("div");
    d.className="msg";
    d.innerHTML=`<strong>üíñ ${m.nombre}</strong><div>${m.mensaje}</div>`;
    listaMensajes.appendChild(d);
  });
  modalMensajes.style.display="flex";
}

/* ===== CARRUSEL ===== */
function renderCarrusel(){
  galeria.innerHTML="";
  fotos.forEach(f=>{
    const i=document.createElement("img");
    i.src=f.url;
    i.onclick=()=>{idx=recuerdos.indexOf(f);mostrar();modal.style.display="flex"};
    galeria.appendChild(i);
  });
  ci=0;
}
function mover(d){
  if(!fotos.length)return;
  ci=(ci+d+fotos.length)%fotos.length;
  galeria.style.transform=`translateX(-${ci*195}px)`;
}

/* ===== MODAL ===== */
function abrirModal(){idx=0;mostrar();modal.style.display="flex"}
function mostrar(){
  const r=recuerdos[idx];
  modalContenido.innerHTML="";
  if(r.type==="image"){
    const i=document.createElement("img");i.src=r.url;
    modalContenido.appendChild(i);
    btnDescargar.onclick=()=>window.open(r.url,"_blank");
  }else{
    const f=document.createElement("iframe");f.src=r.url;
    modalContenido.appendChild(f);
    btnDescargar.style.display="none";
  }
  contador.innerText=`${idx+1} / ${recuerdos.length}`;
}
function siguiente(){idx=(idx+1)%recuerdos.length;mostrar()}
function anterior(){idx=(idx-1+recuerdos.length)%recuerdos.length;mostrar()}
</script>

</body>
</html>
