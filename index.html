<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Alejandra & Ever üíç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:"Georgia",serif;
  background:linear-gradient(#fff,#f9f6f7);
  text-align:center;
  color:#7b1e3a;
}
.container{max-width:620px;margin:auto;padding:40px 20px}
h1{font-size:38px}
.fecha{margin-bottom:30px;color:#a23b5c}
.card{
  background:white;
  padding:32px;
  border-radius:26px;
  box-shadow:0 14px 35px rgba(0,0,0,.08)
}
button{
  margin-top:22px;
  background:#7b1e3a;
  color:white;
  border:none;
  padding:15px 40px;
  border-radius:30px;
  font-size:18px;
  cursor:pointer
}
#estado{margin-top:15px;color:#a23b5c}

/* ===== OVERLAY CARGA ===== */
.overlay{
  position:fixed;inset:0;
  background:rgba(255,255,255,.96);
  z-index:3000;
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column
}
.loader{display:flex;gap:10px}
.loader span{
  font-size:30px;
  color:#7b1e3a;
  animation:latir 1.4s infinite ease-in-out
}
.loader span:nth-child(2){animation-delay:.2s}
.loader span:nth-child(3){animation-delay:.4s}
@keyframes latir{
  0%{transform:scale(1);opacity:.4}
  20%{transform:scale(1.4);opacity:1}
  40%{transform:scale(1);opacity:.4}
  100%{transform:scale(1);opacity:.4}
}

/* ===== MODAL ===== */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.92);
  z-index:2000;
  align-items:center;
  justify-content:center;
  flex-direction:column
}
.modal::before{
  content:"";
  position:absolute;
  inset:0;
  background-size:cover;
  background-position:center;
  filter:blur(25px) brightness(.5);
  transform:scale(1.1);
  z-index:-1
}
.visor{
  width:92%;
  max-width:900px;
  aspect-ratio:4/5;
  background:rgba(0,0,0,.6);
  border-radius:24px;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden
}
.visor img,.visor iframe{
  width:100%;height:100%;
  object-fit:contain;
  border:none
}
.cerrar{
  position:absolute;
  top:20px;right:25px;
  font-size:40px;color:white;cursor:pointer
}
.controles{margin-top:15px;display:flex;gap:40px}
.controles button{
  background:rgba(255,255,255,.2);
  border:none;
  color:white;
  font-size:26px;
  padding:12px 26px;
  border-radius:50%;
  cursor:pointer
}
.descargar{
  margin-top:12px;
  background:rgba(255,255,255,.15);
  color:white;
  border:1px solid rgba(255,255,255,.4);
  padding:8px 18px;
  border-radius:20px;
  font-size:14px;
  cursor:pointer
}
.ios-tip{
  margin-top:8px;
  font-size:13px;
  color:#f1d6de;
  display:none
}
.contador{margin-top:8px;color:white;font-size:13px}
</style>
</head>

<body>

<div class="container">
  <h1>Alejandra & Ever</h1>
  <div class="fecha">üíç 5 ¬∑ septiembre ¬∑ 2026</div>

  <div class="card">
    <p>
      Gracias por acompa√±arnos en uno de los d√≠as m√°s felices de nuestras vidas üíï  
      Ay√∫danos a guardar estos recuerdos para siempre.
    </p>

    <input type="file" id="file" multiple accept="image/*,video/*"><br>
    <button id="btnSubir">Subir recuerdos üì∏üé•</button>
    <p id="estado"></p>
  </div>
</div>

<div id="overlay" class="overlay">
  <div class="loader"><span>‚ù§</span><span>‚ù§</span><span>‚ù§</span></div>
  <p style="margin-top:18px;color:#7b1e3a">
    Estamos guardando este recuerdo con mucho amor‚Ä¶<br>
    Gracias por hacer parte de nuestra historia üíï
  </p>
</div>

<div id="modal" class="modal">
  <span class="cerrar" onclick="cerrarModal()">√ó</span>
  <div class="visor"><div id="modalContenido"></div></div>

  <button id="btnDescargar" class="descargar">Descargar recuerdo ‚¨áÔ∏è</button>
  <div id="iosTip" class="ios-tip">
    En iPhone, mant√©n presionada la imagen para guardarla üíï
  </div>

  <div class="controles">
    <button onclick="anterior()">‚óÄ</button>
    <button onclick="siguiente()">‚ñ∂</button>
  </div>
  <div id="contador" class="contador"></div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbx8VOYLQROH9355Usvu2M7mguRZ8L8X4rL9kKtkH7lTak6JRmXgQkL9BCsRWOE61b2f/exec";
let recuerdos=[],i=0;

const isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent);

function mostrar(){
  const r=recuerdos[i];
  const cont=document.getElementById("modalContenido");
  cont.innerHTML="";
  document.getElementById("modal").style.backgroundImage=
    r.type==="image"?`url(${r.url})`:"none";

  if(r.type==="image"){
    const img=document.createElement("img");
    img.src=r.url;
    cont.appendChild(img);
    btnDescargar.style.display="inline-block";
    iosTip.style.display=isIOS?"block":"none";

    btnDescargar.onclick=async()=>{
      if(isIOS){window.open(r.url,"_blank");return;}
      const b=await fetch(r.url).then(r=>r.blob());
      const u=URL.createObjectURL(b);
      const a=document.createElement("a");
      a.href=u;a.download="recuerdo.jpg";a.click();
      URL.revokeObjectURL(u);
    };
  }else{
    const f=document.createElement("iframe");
    f.src=r.url;f.allow="autoplay";
    cont.appendChild(f);
    btnDescargar.style.display="none";
    iosTip.style.display="none";
  }
  contador.innerText=`${i+1} / ${recuerdos.length}`;
}

function siguiente(){i=(i+1)%recuerdos.length;mostrar()}
function anterior(){i=(i-1+recuerdos.length)%recuerdos.length}
function cerrarModal(){modal.style.display="none"}

async function cargar(){
  recuerdos=await fetch(SCRIPT_URL).then(r=>r.json());
}
cargar();
</script>

</body>
</html>
