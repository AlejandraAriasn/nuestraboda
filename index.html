<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Alejandra & Ever üíç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: "Georgia", serif;
  background: linear-gradient(#ffffff, #f9f6f7);
  text-align: center;
  color: #7b1e3a;
}

.container {
  max-width: 620px;
  margin: auto;
  padding: 40px 20px;
}

h1 { font-size: 38px; }
.fecha { margin-bottom: 30px; color: #a23b5c; }

.card {
  background: white;
  padding: 32px;
  border-radius: 26px;
  box-shadow: 0 14px 35px rgba(0,0,0,0.08);
}

.mensaje { font-size: 17px; }

input[type="file"] { margin-top: 15px; }

button {
  margin-top: 22px;
  background: #7b1e3a;
  color: white;
  border: none;
  padding: 15px 40px;
  border-radius: 30px;
  font-size: 18px;
  cursor: pointer;
}

button:disabled { background: #ccc; }

#estado { margin-top: 15px; }

/* ===== CARRUSEL ===== */
.carousel {
  margin-top: 50px;
  position: relative;
  overflow: hidden;
}

.track {
  display: flex;
  gap: 15px;
  transition: transform 0.6s ease;
}

.track img {
  width: 180px;
  height: 180px;
  object-fit: cover;
  border-radius: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.flecha {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.55);
  color: white;
  border: none;
  font-size: 26px;
  padding: 10px 16px;
  border-radius: 50%;
  cursor: pointer;
  z-index: 10;
}

.flecha.izq { left: 10px; }
.flecha.der { right: 10px; }

/* ===== BOT√ìN VER TODOS ===== */
.ver-todos {
  margin-top: 30px;
  background: transparent;
  border: 2px solid #7b1e3a;
  color: #7b1e3a;
}

.ver-todos:hover {
  background: #7b1e3a;
  color: white;
}

/* ===== MODAL ===== */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

.modal img,
.modal video {
  max-width: 85%;
  max-height: 75%;
  border-radius: 20px;
}

.cerrar {
  position: absolute;
  top: 25px;
  right: 30px;
  font-size: 40px;
  color: white;
  cursor: pointer;
}

.controles {
  margin-top: 25px;
  display: flex;
  gap: 40px;
}

.controles button {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  font-size: 28px;
  padding: 12px 26px;
  border-radius: 50%;
  cursor: pointer;
}

.controles button:hover {
  background: rgba(255,255,255,0.4);
}
</style>
</head>

<body>

<div class="container">
  <h1>Alejandra & Ever</h1>
  <div class="fecha">üíç 5 ¬∑ septiembre ¬∑ 2026</div>

  <div class="card">
    <p class="mensaje">
      Gracias por acompa√±arnos en uno de los d√≠as m√°s felices de nuestras vidas üíï  
      Ay√∫danos a guardar estos recuerdos para siempre.
    </p>

    <input type="file" id="file" multiple accept="image/*,video/*"><br>
    <button id="btnSubir">Subir recuerdos üì∏üé•</button>
    <p id="estado"></p>
  </div>

  <h2 style="margin-top:50px;">Nuestros recuerdos üíï</h2>

  <div class="carousel">
    <button class="flecha izq" onclick="mover(-1)">‚óÄ</button>
    <div class="track" id="galeria"></div>
    <button class="flecha der" onclick="mover(1)">‚ñ∂</button>
  </div>

  <button class="ver-todos" id="btnVerTodos">
    Ver todos los recuerdos üíñ
  </button>
</div>

<div id="modal" class="modal">
  <span class="cerrar" onclick="cerrarModal()">&times;</span>
  <div id="modalContenido"></div>
  <div class="controles">
    <button onclick="anteriorRecuerdo()">‚óÄ</button>
    <button onclick="siguienteRecuerdo()">‚ñ∂</button>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwEY79MGA3RrwfBESl5OAIpfu2Ggv5I8iSUboQ0p1RnnuOvHhT-I-HIpHdcvj4cRAvY/exec";

let recuerdos = [];
let fotosCarrusel = [];
let indexCarrusel = 0;
let autoTimer = null;
let indiceRecuerdo = 0;

/* ===== SUBIDA M√öLTIPLE ===== */
document.getElementById("btnSubir").onclick = async () => {
  const files = document.getElementById("file").files;
  const estado = document.getElementById("estado");
  if (!files.length) return;

  estado.innerText = "Subiendo recuerdos... üíï";

  for (const file of files) {
    const reader = new FileReader();
    await new Promise(resolve => {
      reader.onload = async () => {
        await fetch(SCRIPT_URL, {
          method: "POST",
          body: JSON.stringify({
            name: file.name,
            type: file.type,
            base64: reader.result.split(",")[1]
          })
        });
        resolve();
      };
      reader.readAsDataURL(file);
    });
  }

  estado.innerText = "¬°Recuerdos guardados con √©xito! üíñ";
  cargarGaleria();
};

/* ===== CARGAR DATOS ===== */
async function cargarGaleria() {
  const res = await fetch(SCRIPT_URL);
  recuerdos = await res.json();

  fotosCarrusel = recuerdos.filter(r => r.url.includes("thumbnail"));

  renderCarrusel();
  iniciarAuto();
}

/* ===== CARRUSEL CIRCULAR ===== */
function renderCarrusel() {
  const galeria = document.getElementById("galeria");
  galeria.innerHTML = "";

  fotosCarrusel.forEach(f => {
    const img = document.createElement("img");
    img.src = f.url;
    galeria.appendChild(img);
  });

  indexCarrusel = 0;
  actualizarCarrusel();
}

function mover(dir) {
  indexCarrusel = (indexCarrusel + dir + fotosCarrusel.length) % fotosCarrusel.length;
  actualizarCarrusel();
  reiniciarAuto();
}

function actualizarCarrusel() {
  const ancho = 195; // imagen + gap
  document.getElementById("galeria").style.transform =
    `translateX(-${indexCarrusel * ancho}px)`;
}

function iniciarAuto() {
  clearInterval(autoTimer);
  autoTimer = setInterval(() => mover(1), 3500);
}

function reiniciarAuto() {
  iniciarAuto();
}

/* ===== MODAL SLIDESHOW ===== */
document.getElementById("btnVerTodos").onclick = () => {
  if (!recuerdos.length) return;
  indiceRecuerdo = 0;
  mostrarRecuerdo();
  document.getElementById("modal").style.display = "flex";
};

function mostrarRecuerdo() {
  const cont = document.getElementById("modalContenido");
  cont.innerHTML = "";
  const r = recuerdos[indiceRecuerdo];

  if (r.url.includes("thumbnail")) {
    const img = document.createElement("img");
    img.src = r.url;
    cont.appendChild(img);
  } else {
    const video = document.createElement("video");
    video.src = r.url;
    video.controls = true;
    video.autoplay = true;
    cont.appendChild(video);
  }
}

function siguienteRecuerdo() {
  indiceRecuerdo = (indiceRecuerdo + 1) % recuerdos.length;
  mostrarRecuerdo();
}

function anteriorRecuerdo() {
  indiceRecuerdo = (indiceRecuerdo - 1 + recuerdos.length) % recuerdos.length;
  mostrarRecuerdo();
}

function cerrarModal() {
  document.getElementById("modal").style.display = "none";
}

/* INIT */
cargarGaleria();
</script>

</body>
</html>
